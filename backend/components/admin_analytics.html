<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Admin Analytics</title>
    <style>
      body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:20px}
      table{border-collapse:collapse;width:100%}
      th,td{border:1px solid #ddd;padding:8px}
      th{background:#f4f4f4}
    </style>
  </head>
  <body>
    <h1>Analytics Summary</h1>
    <div id="status">Loadingâ€¦</div>
    <h2>Counts by event</h2>
    <table id="counts"><thead><tr><th>Event</th><th>Count</th></tr></thead><tbody></tbody></table>

    <script>
      async function load() {
        const r = await fetch('/api/analytics/summary');
        if (!r.ok) { document.getElementById('status').innerText = 'Failed to load'; return }
        const j = await r.json();
        document.getElementById('status').innerText = '';
        const tbody = document.querySelector('#counts tbody');
        tbody.innerHTML = '';
        for (const [event, count] of Object.entries(j.counts_by_event || {})) {
          const tr = document.createElement('tr');
          const a = document.createElement('td'); a.innerText = event;
          const b = document.createElement('td'); b.innerText = count;
          tr.appendChild(a); tr.appendChild(b); tbody.appendChild(tr);
        }
      }
      load();
    </script>
  </body>
  </html>
